generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model users {
  id                Int      @id @default(autoincrement())
  full_name         String   @db.VarChar(100)
  email             String   @unique @db.VarChar(100)
  password          String   @db.VarChar(255)
  created_at        DateTime @default(now()) @db.Timestamp(6)

  // Relations
  novels_created    novels[] @relation("NovelCreator")
  novels_updated    novels[] @relation("NovelUpdater")
}

model novels {
  public_id      String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  chapters       Int      @default(0)
  views          Int      @default(0)
  author_name    String   @db.VarChar(255)
  title          String   @db.VarChar(500)
  categories     Json
  novel_summary  String   @db.Text
  created_at     DateTime @default(now()) @db.Timestamp(6)
  updated_at     DateTime @updatedAt @db.Timestamp(6)
  created_by     Int
  updated_by     Int?

  // Relations
  creator        users    @relation("NovelCreator", fields: [created_by], references: [id], onDelete: Restrict)
  updater        users?   @relation("NovelUpdater", fields: [updated_by], references: [id], onDelete: Restrict)

  @@index([author_name], name: "idx_novels_author_name")
  @@index([title], name: "idx_novels_title")
  @@index([created_at], name: "idx_novels_created_at")
  @@index([created_by], name: "idx_novels_created_by")
  @@index([views], name: "idx_novels_views")
  @@map("novels")
}
